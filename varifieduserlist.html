<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0">
<!-- Site Icons -->
<link rel="shortcut icon" href="images/logo-removebg-preview.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="images/logo-removebg-preview.png">
    <!-- Site Metas -->
    <title>Mahalaxmi Masala</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- color -->
    <link id="changeable-colors" rel="stylesheet" href="css/colors/orange.css" />

    <!-- Modernizer -->
    <script src="js/modernizer.js"></script>
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <!-- Modernizer -->
    <!-- <script src="js/modernizer.js"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script> -->

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

<body>
    <div id="loader">
        <div id="status"></div>
    </div>
    <div id="site-header" style="background-color: #1a1a1a;">
        <header id="header" class="header-block-top" style="background-color: #1a1a1a;">
            <div class="container-fluid">
                <div class="row">
                    <!-- <div class="col-12 d-flex justify-content-between align-items-center">
                        <div class="logo">
                            <a href="index.html">
                                <img src="images/logo-removebg-preview.png" alt="Mahalaxmi Logo" style="max-height: 60px; margin: 10px;">
                            </a>
                        </div> -->
                        <div class="main-menu">
                            <nav class="navbar navbar-default" id="mainNav">
                                <div class="navbar-header">
                                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                    </button>
                                    <div class="logo">
                                        <a class="navbar-brand js-scroll-trigger logo-header" href="#">
                                            <img src="images/mahalaxmi-logo.png" alt="">
                                        </a>
                                    </div>
                                </div>
                                <div id="navbar" class="navbar-collapse collapse">
                                    <ul class="nav navbar-nav navbar-right">
                                        <li ><a href="./index.html">HOME</a></li> 
                                        <li ><a href="index.html#about">ABOUT</a></li>
                                        <li ><a href="index.html#special-collection">COLLECTION</a></li>
                                        <li ><a href="index.html#our_team">NEWS</a></li>
                                        <!-- <li ><a href="index.html#contact">CONTACT</a></li> -->
                                        <li  ><a href="./stockAllocationForm.html">INVESTOR FORM</a></li>
                                        <li><a href="./varifiedCertificate.html">Certificate Verify</a></li>
                                        <!--<li><a href="#">View Certificate</a></li>-->
                                        <!-- <li><a href="./login.html">Login</a></li> -->
                                     
                                    </ul>
                                </div>
                                <!-- end nav-collapse -->
                            </nav>
                            <!-- <nav class="navbar navbar-expand-lg">
                                <button
                                  class="navbar-toggler"
                                  type="button"
                                  data-bs-toggle="collapse"
                                  data-bs-target="#navbar"
                                >
                                  <span class="navbar-toggler-icon"></span>
                                </button>
                                <div id="navbar" class="collapse navbar-collapse">
                                  <ul class="navbar-nav ms-auto">
                                    <li style="padding-top: 20px">
                                      <a href="./index.html">HOME</a>
                                    </li>
                                    <li style="padding-top: 20px">
                                      <a href="index.html#about">ABOUT</a>
                                    </li>
                                    <li style="padding-top: 20px">
                                      <a href="index.html#special-collection"
                                        >COLLECTION</a
                                      >
                                    </li>
                                    <li style="padding-top: 20px">
                                      <a href="index.html#our_team">NEWS</a>
                                    </li>
                                    <li style="padding-top: 20px">
                                      <a href="index.html#contact">CONTACT</a>
                                    </li>
                                    <li style="padding-top: 20px">
                                      <a href="./stockAllocationForm.html">INVESTOR FORM</a>
                                    </li>
                                   
                                  </ul>
                                </div>
                              </nav> -->
                        </div>
                    </div>
                </div>
            </div>
        </header>
    </div>
    
	<!-- end site-header -->
	
    <section style="margin-top: 120px;">
   
        <div class="container-fluid">
         <div class="d-flex justify-content-end mb-4" style="display: flex; justify-content: flex-end;">
             <a href="userlist.html">
             <button class="btn btn-danger" style="font-size: 18px; padding: 12px 24px ; font-weight: 500; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 30px; ">
                 View Pending Investors List
             </button>
         </a>
         </div>
     </div>     
        </section>
     <section id="banner" >
    <div class="loading-spinner" style="display:none;">Loading...</div>
<div class="overlay" style="display:none;"></div>
    <div class="container-fluid py-4">
        <div class="card shadow-sm">
            <div class="card-header bg-danger text-white d-flex justify-content-between align-items-center" style=" background-color:#EC3236">
                <h4 class="pt-5 pb-5" style="padding: 10px;color:aliceblue;font-weight: 600;">All Investors List</h4>
                <!-- <input type="text" class="form-control form-control-sm w-auto" placeholder="Search..." id="searchInput"> -->
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover table-striped">
                        <thead class="table-light">
                            <tr>
                                                             <th>Date</th>
                                <th>Name(s) of Holder(s)</th>
                                <th>Occupation</th>
                                <th>Address</th>
                                <th>Contact No.</th>
                                <th>Nominee Name And Address</th>
                                <th>Total Amount (â‚¹)</th>
                                <th>Total Amount in Words</th>
                                <th>Monthly Returns </th>
                                
                                <th>Edit</th>
                                
                                <th>Delete</th>
                                <th>Download</th>

                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                <div class="d-flex justify-content-between align-items-center mt-3">
                    <div class="text-muted">
                        Showing <span id="startRange">0</span> to <span id="endRange">0</span> of <span id="totalEntries">0</span> entries
                    </div>
                    <nav aria-label="Page navigation">
                        <ul class="pagination" id="pagination"></ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- User Details Modal -->
<div class="modal fade" id="userDetailsModal" tabindex="-1" aria-labelledby="userDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="userDetailsModalLabel">Investor Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="fw-bold">Name(s) of Holder(s):</label>
                        <p id="modalName"></p>
                    </div>
                    <div class="col-md-6">
                        <label class="fw-bold">Occupation:</label>
                        <p id="modalOccupation"></p>
                    </div>
                    <div class="col-12">
                        <label class="fw-bold">Address:</label>
                        <p id="modalAddress"></p>
                    </div>
                    <div class="col-md-6">
                        <label class="fw-bold">Contact No:</label>
                        <p id="modalContact"></p>
                    </div>
                    <div class="col-md-6">
                        <label class="fw-bold">Date:</label>
                        <p id="modalDate"></p>
                    </div>
                    <div class="col-12">
                        <label class="fw-bold">Nominee Name & Address:</label>
                        <p id="modalNominee"></p>
                    </div>
                    <div class="col-md-4">
                        <label class="fw-bold">Total Amount:</label>
                        <p id="modalAmount"></p>
                    </div>
                    <div class="col-md-4">
                        <label class="fw-bold">Monthly Returns:</label>
                        <p id="modalReturns"></p>
                    </div>
                    <div class="col-md-4">
                        <label class="fw-bold">Valid Till:</label>
                        <p id="modalValidTill"></p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

    
 </section>
   

 <div id="footer" class="footer-main">

    <div class="footer-box pad-top-70">
        <div class="container-fluid">
            <div class="row">
                <div class="footer-in-main">
                    <div class="footer-logo">
                        <div class="text-center">
                            <img src="images/logo.png" alt="" />
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                        <div class="footer-box-a">
                            <h3>About Us</h3>
                            <p>We Organic khandeshi food products through our reputed brand "Original Mahalaxmi", we bring tradition, taste, and quality together to create
                                authentic spice blends loved by families across generations. Our journey began with a simple
                                yet powerful visionâ€”to offer pure, high-quality masalas that enrich every meal with flavor
                                and authenticity.</p>
                        

                        </div>
                                               </div> 
                    <!-- end col -->
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                        <div class="footer-box-b">
                            <h3>Useful Links</h3>
                            <ul>
                              
                                <li><a href="index.html#about">About us</a></li>
                                <li><a href="index.html#special-collection">Special Collection</a></li>
                                <li><a href="index.html#news">News</a></li>
                                <li><a href="index.html#contact">Contact us</a></li>
                            </ul>
                        </div>
                     </div> 
                    <!-- end col -->
                     <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                        <div class="footer-box-c">
                            <h3>Contact Us</h3>
                            <p>
                                <i class="fa fa-map-signs" aria-hidden="true"></i>
                                <span>D-112, M.I.D.C., Jalgaon  </span>
                            </p>
                            <p>
                                <i class="fa fa-mobile" aria-hidden="true"></i>
                                <span>
                                    +91 7498211029
                                </span>
                            </p>
                            <p>
                                <i class="fa fa-envelope" aria-hidden="true"></i>
                                <span><a href="#">originalmahalaxmi@gmail.com</a></span>
                            </p>
                        </div>
                    </div> 
                   
                </div>
                <!-- end footer-in-main -->
            </div>
            <!-- end row -->
        </div>
        <!-- end container -->
        <div id="copyright" class="copyright-main">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <h6 class="copy-title"> Copyright &copy; Original Mahalaxmi Masale <a href="#"
                                target="_blank"></a> </h6>
                    </div>
                </div>
                <!-- end row -->
            </div>
            <!-- end container -->
        </div>
        <!-- end copyright-main -->
    </div>
    <!-- end footer-box -->
</div>
    <!-- end footer-main -->

    <a href="#" class="scrollup" style="display: none;">Scroll</a>

 

    <!-- ALL JS FILES -->
    <script src="js/all.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
    <script src="js/custom.js"></script>
   
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script>
         let currentPage = 0;
        let currentEditId = null;
        // const editModal = new bootstrap.Modal(document.getElementById('editModal'));

        function toggleLoading(show) {
            document.querySelector('.loading-spinner').style.display = show ? 'block' : 'none';
            document.querySelector('.overlay').style.display = show ? 'block' : 'none';
        }

        function formatDate(dateString) {
            if (!dateString) return '-';
            return new Date(dateString).toLocaleDateString('en-GB');
        }

        function calculateReturns(amount) {
            const monthlyRate = 0.03;
            const yearlyRate = 0.36;
            return {
                monthly: amount * monthlyRate,
                yearly: amount * yearlyRate
            };
        }
        function updatePagination(totalPages) {
    const pagination = document.getElementById('pagination');
    pagination.innerHTML = '';

    // Previous button
    const prevLi = document.createElement('li');
    prevLi.className = `page-item ${currentPage === 0 ? 'disabled' : ''}`;
    prevLi.innerHTML = '<a class="page-link" href="#">Previous</a>';
    prevLi.onclick = () => {
        if (currentPage > 0) {
            currentPage--;
            displayData(currentPage);
        }
    };
    pagination.appendChild(prevLi);

    // Page numbers
    for (let i = 0; i < totalPages; i++) {
        const li = document.createElement('li');
        li.className = `page-item ${currentPage === i ? 'active' : ''}`;
        li.innerHTML = `<a class="page-link" href="#">${i + 1}</a>`;
        li.onclick = () => {
            currentPage = i;
            displayData(currentPage);
        };
        pagination.appendChild(li);
    }

    // Next button
    const nextLi = document.createElement('li');
    nextLi.className = `page-item ${currentPage === totalPages - 1 ? 'disabled' : ''}`;
    nextLi.innerHTML = '<a class="page-link" href="#">Next</a>';
    nextLi.onclick = () => {
        if (currentPage < totalPages - 1) {
            currentPage++;
            displayData(currentPage);
        }
    };
    pagination.appendChild(nextLi);
}

function updateRange(start, end, total) {
    document.getElementById('startRange').textContent = start;
    document.getElementById('endRange').textContent = end;
    document.getElementById('totalEntries').textContent = total;
}

// Initialize display when document loads
document.addEventListener('DOMContentLoaded', () => {
    displayData(currentPage);
});

async function fetchData(page = 0) {
    toggleLoading(true);
    try {
        const response = await fetch(`https://originalmahalaxmi.com:8084/api/v1/users?page=${page}`);
        if (!response.ok) throw new Error('Failed to fetch data');
        const allData = await response.json();
        
        // Calculate start and end index for pagination
        const startIndex = page * 10;
        const endIndex = startIndex + 10;
        
        return {
            content: allData.slice(startIndex, endIndex),
            totalPages: Math.ceil(allData.length / 10),
            totalItems: allData.length,
            currentPage: page
        };
    } catch (error) {
        console.error('Error:', error);
        alert('Error loading data');
        return { content: [], currentPage: 0, totalPages: 0, totalItems: 0 };
    } finally {
        toggleLoading(false);
    }
}

async function displayData(page) {
    const data = await fetchData(page);
    const tableBody = document.getElementById('tableBody');
    tableBody.innerHTML = '';

    data.content.forEach(item => {
        const amount = parseFloat(item.totalAmount);
        const returns = calculateReturns(amount);
        
        const row = document.createElement('tr');
        row.innerHTML = `
    <td>${formatDate(item.date ? item.date : item.validTill)}</td>
    <td>${item.nameOfHolders}</td>
    <td>${item.occupation}</td>
    <td>${item.address}</td>
    <td>${item.contactNo}</td>
    <td>${item.nomineeNameAndAddress}</td>
    <td>â‚¹${amount.toLocaleString()}</td>
    <td>${item.roi ? item.roi : "0"}%</td>
    <td>
        <button class="btn btn-sm btn-primary" onclick="editItem('${item.id}')">Edit</button>
    </td>
    <td>
        <button class="btn btn-sm btn-danger" onclick="deleteItem('${item.id}')">Delete</button>
    </td>
    <td>
         <button class="btn btn-sm btn-success" onclick="downloadCertificate('${item.certificateURL}')">Download</button>
    </td>

`;
tableBody.appendChild(row);


    });

    updatePagination(data.totalPages);
    updateRange(
        page * 10 + 1,
        Math.min((page + 1) * 10, data.totalItems),
        data.totalItems
    );
}

function downloadCertificate(url) {
  if (!url) {
    alert("Certificate URL not available.");
    return;
  }

  // Fetch the file and create a blob for downloading
  fetch(url)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.blob();
    })
    .then(blob => {
      const blobUrl = window.URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = blobUrl;
      link.download = url.split("/").pop(); // Extract the file name from the URL
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      window.URL.revokeObjectURL(blobUrl); // Clean up the object URL
    })
    .catch(error => {
      console.error("Failed to download file:", error);
      alert("Failed to download the certificate. Please try again.");
    });
}

    async function editItem(id) { window.location.href=`edituser.html?id=${id}`
        }
       

 
   // delete data
   async function deleteItem(id) {
         
         if (!confirm('Are you sure you want to delete this ?')) {
             return;
         }
     
         toggleLoading(true);
         try {
             const response = await fetch(`https://originalmahalaxmi.com:8084/api/v1/admin/delete/${id}`, {
                 method: 'DELETE',
                 headers: {
                     'Content-Type': 'application/json'
                 }
             });
     
             if (!response.ok) {
                 throw new Error('Failed to delete item');
             }
     
             alert('Record deleted successfully');
             // Refresh the data
             displayData(currentPage);
         } catch (error) {
             console.error('Error:', error);
             alert('Error deleting item. Please try again.');
         } finally {
             toggleLoading(false);
         }
     }
         
    </script> -->
    
    <script>
        let currentPage = 0;
        let currentEditId = null;
    
        function toggleLoading(show) {
            document.querySelector('.loading-spinner').style.display = show ? 'block' : 'none';
            document.querySelector('.overlay').style.display = show ? 'block' : 'none';
        }
    
        function formatDate(dateString) {
            if (!dateString) return '-';
            return new Date(dateString).toLocaleDateString('en-GB');
        }
    
        function calculateReturns(amount) {
            const monthlyRate = 0.03;
            const yearlyRate = 0.36;
            return {
                monthly: amount * monthlyRate,
                yearly: amount * yearlyRate
            };
        }
    
        function numberToWords(num) {
            if (num === 0) return 'Zero';
    
            const belowTwenty = [
                '', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten',
                'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen',
                'Eighteen', 'Nineteen'
            ];
    
            const tens = [
                '', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'
            ];
    
            const scales = ['', 'Thousand', 'Lakh', 'Crore'];
    
            let words = '';
    
            function getBelowThousand(n) {
                if (n < 20) {
                    return belowTwenty[n];
                } else if (n < 100) {
                    return tens[Math.floor(n / 10)] + (n % 10 !== 0 ? ' ' + belowTwenty[n % 10] : '');
                } else {
                    return belowTwenty[Math.floor(n / 100)] + ' Hundred' + (n % 100 !== 0 ? ' ' + getBelowThousand(n % 100) : '');
                }
            }
    
            let scaleIndex = 0;
    
            while (num > 0) {
                let currentChunk = num % 1000;
    
                if (scaleIndex === 1) {
                    currentChunk = num % 100;
                    num = Math.floor(num / 100);
                } else {
                    num = Math.floor(num / 1000);
                }
    
                if (currentChunk > 0) {
                    const chunkWords = getBelowThousand(currentChunk);
                    words = chunkWords + (scales[scaleIndex] ? ' ' + scales[scaleIndex] : '') + (words ? ' ' + words : '');
                }
    
                scaleIndex++;
            }
    
            return words.trim();
        }
    
        function updatePagination(totalPages) {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
    
            const prevLi = document.createElement('li');
            prevLi.className = `page-item ${currentPage === 0 ? 'disabled' : ''}`;
            prevLi.innerHTML = '<a class="page-link" href="#">Previous</a>';
            prevLi.onclick = () => {
                if (currentPage > 0) {
                    currentPage--;
                    displayData(currentPage);
                }
            };
            pagination.appendChild(prevLi);
    
            for (let i = 0; i < totalPages; i++) {
                const li = document.createElement('li');
                li.className = `page-item ${currentPage === i ? 'active' : ''}`;
                li.innerHTML = `<a class="page-link" href="#">${i + 1}</a>`;
                li.onclick = () => {
                    currentPage = i;
                    displayData(currentPage);
                };
                pagination.appendChild(li);
            }
    
            const nextLi = document.createElement('li');
            nextLi.className = `page-item ${currentPage === totalPages - 1 ? 'disabled' : ''}`;
            nextLi.innerHTML = '<a class="page-link" href="#">Next</a>';
            nextLi.onclick = () => {
                if (currentPage < totalPages - 1) {
                    currentPage++;
                    displayData(currentPage);
                }
            };
            pagination.appendChild(nextLi);
        }
    
        function updateRange(start, end, total) {
            document.getElementById('startRange').textContent = start;
            document.getElementById('endRange').textContent = end;
            document.getElementById('totalEntries').textContent = total;
        }
    
        document.addEventListener('DOMContentLoaded', () => {
            displayData(currentPage);
        });
    
        async function fetchData(page = 0) {
            toggleLoading(true);
            try {
                const response = await fetch(`https://originalmahalaxmi.com:8084/api/v1/users?page=${page}`);
                if (!response.ok) throw new Error('Failed to fetch data');
                const allData = await response.json();
    
                const startIndex = page * 10;
                const endIndex = startIndex + 10;
    
                return {
                    content: allData.slice(startIndex, endIndex),
                    totalPages: Math.ceil(allData.length / 10),
                    totalItems: allData.length,
                    currentPage: page
                };
            } catch (error) {
                console.error('Error:', error);
                alert('Error loading data');
                return { content: [], currentPage: 0, totalPages: 0, totalItems: 0 };
            } finally {
                toggleLoading(false);
            }
        }
    
        async function displayData(page) {
            const data = await fetchData(page);
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
    
            data.content.forEach(item => {
                const amount = parseFloat(item.totalAmount);
                const amountInWords = numberToWords(amount);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatDate(item.date ? item.date : item.validTill)}</td>
                    <td>${item.nameOfHolders}</td>
                    <td>${item.occupation}</td>
                    <td>${item.address}</td>
                    <td>${item.contactNo}</td>
                    <td>${item.nomineeNameAndAddress}</td>
                    <td>â‚¹${amount.toLocaleString()}</td>
                    <td>${item.roi ? item.roi : "0"}%</td>
                    <td>${amountInWords} Rupees</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editItem('${item.id}')">Edit</button>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-danger" onclick="deleteItem('${item.id}')">Delete</button>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-success" onclick="downloadCertificate('${item.certificateURL}')">Download</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
    
            updatePagination(data.totalPages);
            updateRange(
                page * 10 + 1,
                Math.min((page + 1) * 10, data.totalItems),
                data.totalItems
            );
        }
    
        function downloadCertificate(url) {
            if (!url) {
                alert("Certificate URL not available.");
                return;
            }
    
            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.blob();
                })
                .then(blob => {
                    const blobUrl = window.URL.createObjectURL(blob);
                    const link = document.createElement("a");
                    link.href = blobUrl;
                    link.download = url.split("/").pop();
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    window.URL.revokeObjectURL(blobUrl);
                })
                .catch(error => {
                    console.error("Failed to download file:", error);
                    alert("Failed to download the certificate. Please try again.");
                });
        }
    
        async function editItem(id) { 
            window.location.href = `edituser.html?id=${id}`;
        }
    
        async function deleteItem(id) {
            if (!confirm('Are you sure you want to delete this?')) {
                return;
            }
    
            toggleLoading(true);
            try {
                const response = await fetch(`https://originalmahalaxmi.com:8084/api/v1/admin/delete/${id}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
    
                if (!response.ok) {
                    throw new Error('Failed to delete item');
                }
    
                alert('Record deleted successfully');
                displayData(currentPage);
            } catch (error) {
                console.error('Error:', error);
                alert('Error deleting item. Please try again.');
            } finally {
                toggleLoading(false);
            }
        }
    </script>
    
    
    <script>
        // Check for sessionStorage values
        document.addEventListener('DOMContentLoaded', function() {
            const token = sessionStorage.getItem("token");
            const message = sessionStorage.getItem("message");
            const status = sessionStorage.getItem("status");
    
            // Target the navbar
            const navbar = document.querySelector(".navbar-nav");
    
            // Logout Button
            const logoutItem = `
              <li class="nav-item">
                  <a class="nav-link text-white active" href="./userlist.html">INVESTOR LIST</a>
                
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="#" id="logoutBtn">LOGOUT</a>
                </li>
            `;
    
            // Login Button
            const loginItem = `
                <li class="nav-item">
                    <a class="nav-link text-white" href="./login.html">LOGIN</a>
                </li>
            `;
    
            if (token && message && status) {
                // If token, message, and status exist, show logout button
                navbar.innerHTML += logoutItem;
    
                // Add event listener for logout
                document.getElementById("logoutBtn").addEventListener("click", function() {
                    // Clear sessionStorage and redirect
                    sessionStorage.clear();
                    alert("You have successfully logged out.");
                    window.location.href = 'index.html';
                });
            } else {
                // If not logged in, ensure login button is visible
                navbar.innerHTML += loginItem;
            }
        });
    </script>
    
</body>

</html>