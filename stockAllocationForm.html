<!DOCTYPE html>
<html lang="en">

<head>

    <!-- Basic -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0">

    <!-- Site Metas -->
    <title>Food Funday Restaurant - One page HTML Responsive</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- color -->
    <link id="changeable-colors" rel="stylesheet" href="css/colors/orange.css" />

    <!-- Modernizer -->
    <script src="js/modernizer.js"></script>

</head>
<style>
    body {
      background-color: #f8f9fa;
    }
    .form-container {
      max-width: 80%;
      margin: 40px auto;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }
    .form-header {
      text-align: center;
      margin-bottom: 20px;
    }
    #site-header {
    background-color: black;
}
   
  </style>
<body>
    <div id="loader">
        <div id="status"></div>
    </div>
    <div id="site-header">
        <header id="header">
            <div class="container">
                <div class="row">
                    <div class="main-menu">
                        <!-- navbar -->
                        <nav class="navbar navbar-default" id="mainNav">
                            <div class="navbar-header">
                                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                                <div class="logo">
                                    <a class="navbar-brand js-scroll-trigger logo-header" href="#">
                                        <img src="images/logo.png" alt="">
                                    </a>
                                </div>
                            </div>
                            <div id="navbar" class="navbar-collapse collapse">
                                <ul class="nav navbar-nav navbar-right">
                                    <li ><a href="./index.html">Home</a></li>
                                    <li><a href="index.html#about">About us</a></li>
                                    <li><a href="index.html#special-collection">Special Collection</a></li>
                                    <li><a href="index.html#our_team">News</a></li>
                                    <li><a href="index.html#contact">Contact us</a></li>
                                    <li class="active"><a href="./stockAllocationForm.html">Stakeholders Certificate</a></li>
                                    <!-- <li><a href="./login.html">Login</a></li> -->
                                 
                                </ul>
                            </div>
                            <!-- end nav-collapse -->
                        </nav>
                        <!-- end navbar -->
                    </div>
                </div>
                <!-- end row -->
            </div>
            <!-- end container-fluid -->
        </header>
        <!-- end header -->
    </div>
	<!-- end site-header -->
	
  
    <div class="form-container">
        <h2 class="form-header">Stock Allocation Form</h2>
        <form id="stockAllocationForm">
          <div class="row g-3">
            <div class="col-md-6">
              <label for="date" class="form-label">DATE<span class="text-danger">*</span></label>
              <input type="date" id="date" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="holderName" class="form-label">NAME(S) OF HOLDER(S)<span class="text-danger">*</span></label>
              <input type="text" id="holderName" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="occupation" class="form-label">OCCUPATION<span class="text-danger">*</span></label>
              <input type="text" id="occupation" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="address" class="form-label">ADDRESS<span class="text-danger">*</span></label>
              <textarea id="address" class="form-control" rows="3" required></textarea>
            </div>
            <div class="col-md-6">
              <label for="contactNo" class="form-label">MOBILE / CONTACT NO.<span class="text-danger">*</span></label>
              <input type="number" id="contactNo" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="nomineeDetails" class="form-label">NOMINEE NAME & ADDRESS: 
                (only in case of death of member)</label>
              <textarea id="nomineeDetails" class="form-control" rows="3"></textarea>
            </div>
            <div class="col-md-6">
              <label for="totalAmount" class="form-label">TOTAL AMOUNT IN RS.<span class="text-danger">*</span></label>
              <input type="number" id="totalAmount" class="form-control" required>
            </div>
          </div>
          <div class="text-center mt-4">
            <button type="button" class="btn btn-lg" style="background-color: #ED3136;color: #FFFFFF;margin: 5px;" onclick="submitForm()">Submit</button>
          </div>
        </form>
      </div>
        <!-- end footer-news -->
        <div class="footer-box pad-top-70">
            <div class="container">
                <div class="row">
                    <div class="footer-in-main">
                        <div class="footer-logo">
                            <div class="text-center">
                                <img src="images/logo.png" alt="" />
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="footer-box-a">
                                <h3>About Us</h3>
                                <p>Aenean commodo ligula eget dolor aenean massa. Cum sociis nat penatibu set magnis dis parturient montes.</p>
                                <ul class="socials-box footer-socials pull-left">
                                    <li>
                                        <a href="#">
                                            <div class="social-circle-border"><i class="fa  fa-facebook"></i></div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <div class="social-circle-border"><i class="fa fa-twitter"></i></div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <div class="social-circle-border"><i class="fa fa-google-plus"></i></div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <div class="social-circle-border"><i class="fa fa-pinterest"></i></div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <div class="social-circle-border"><i class="fa fa-linkedin"></i></div>
                                        </a>
                                    </li>
                                </ul>

                            </div>
                            <!-- end footer-box-a -->
                        </div>
                        <!-- end col -->
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="footer-box-b">
                                <h3>New Menu</h3>
                                <ul>
                                    <li><a href="#">Italian Bomba Sandwich</a></li>
                                    <li><a href="#">Double Dose of Pork Belly</a></li>
                                    <li><a href="#">Spicy Thai Noodles</a></li>
                                    <li><a href="#">Triple Truffle Trotters</a></li>
                                </ul>
                            </div>
                            <!-- end footer-box-b -->
                        </div>
                        <!-- end col -->
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="footer-box-c">
                                <h3>Contact Us</h3>
                                <p>
                                    <i class="fa fa-map-signs" aria-hidden="true"></i>
                                    <span>6 E Esplanade, St Albans VIC 3021, Australia</span>
                                </p>
                                <p>
                                    <i class="fa fa-mobile" aria-hidden="true"></i>
                                    <span>
									+91 80005 89080 
								</span>
                                </p>
                                <p>
                                    <i class="fa fa-envelope" aria-hidden="true"></i>
                                    <span><a href="#">support@foodfunday.com</a></span>
                                </p>
                            </div>
                            <!-- end footer-box-c -->
                        </div>
                        <!-- end col -->
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="footer-box-d">
                                <h3>Opening Hours</h3>

                                <ul>
                                    <li>
                                        <p>Monday - Thursday </p>
                                        <span> 11:00 AM - 9:00 PM</span>
                                    </li>
                                    <li>
                                        <p>Friday - Saturday </p>
                                        <span>  11:00 AM - 5:00 PM</span>
                                    </li>
                                </ul>
                            </div>
                            <!-- end footer-box-d -->
                        </div>
                        <!-- end col -->
                    </div>
                    <!-- end footer-in-main -->
                </div>
                <!-- end row -->
            </div>
            <!-- end container -->
            <div id="copyright" class="copyright-main">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <h6 class="copy-title"> Copyright &copy; 2017 Food Funday is powered by <a href="#" target="_blank"></a> </h6>
                        </div>
                    </div>
                    <!-- end row -->
                </div>
                <!-- end container -->
            </div>
            <!-- end copyright-main -->
        </div>
        <!-- end footer-box -->
    </div>
    <!-- end footer-main -->

    <a href="#" class="scrollup" style="display: none;">Scroll</a>

    <section id="color-panel" class="close-color-panel">
        <a class="panel-button gray2"><i class="fa fa-cog fa-spin fa-2x"></i></a>
        <!-- Colors -->
        <div class="segment">
            <h4 class="gray2 normal no-padding">Color Scheme</h4>
            <a title="orange" class="switcher orange-bg"></a>
            <a title="strong-blue" class="switcher strong-blue-bg"></a>
            <a title="moderate-green" class="switcher moderate-green-bg"></a>
            <a title="vivid-yellow" class="switcher vivid-yellow-bg"></a>
        </div>
    </section>

    <!-- ALL JS FILES -->
    <script src="js/all.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
    <script src="js/custom.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Authentication and Navigation Functions
      function checkAuth() {
          const token = sessionStorage.getItem('token');
          const authRequired = document.querySelectorAll('.auth-required');
          const loginBtn = document.querySelector('.login-btn');
          const logoutBtn = document.querySelector('.logout-btn');
      
          if (token) {
              authRequired.forEach(item => item.style.display = 'block');
              loginBtn.style.display = 'none';
              logoutBtn.style.display = 'block';
          } else {
              authRequired.forEach(item => item.style.display = 'none');
              loginBtn.style.display = 'block';
              logoutBtn.style.display = 'none';
          }
      }
  
      function handleProtectedLink(targetPage) {
          const token = sessionStorage.getItem('token');
          if (!token) {
              sessionStorage.setItem('requestedPage', targetPage);
              window.location.href = 'login.html';
              return false;
          }
          window.location.href = targetPage;
          return true;
      }
      
      function logout() {
          sessionStorage.clear();
          window.location.href = 'index.html';
      }
      
      function redirectToLogin() {
          sessionStorage.setItem('requestedPage', window.location.pathname);
          window.location.href = 'login.html';
      }
  
      // Form Functions
      function validateForm(formData) {
        for (const [key, value] of Object.entries(formData)) {
          if (value === "" || value === null || (typeof value === "number" && isNaN(value))) {
            alert(`Please fill in the ${key} field.`);
            return false;
          }
        }
        return true;
      }
    
      function getCurrentLocation() {
        return new Promise((resolve, reject) => {
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
              (position) => {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`)
                  .then((response) => response.json())
                  .then((data) => {
                    resolve(data.address.city || "Unknown Location");
                  })
                  .catch((error) => {
                    console.error("Error fetching location:", error);
                    resolve("Unknown Location");
                  });
              },
              (error) => {
                console.error("Error getting geolocation:", error);
                resolve("Unknown Location");
              }
            );
          } else {
            console.error("Geolocation is not supported by this browser.");
            resolve("Unknown Location");
          }
        });
      }
    
      async function submitForm() {
        const place = await getCurrentLocation();
    
        const formData = {
          nameOfHolders: document.getElementById('holderName').value.trim(),
          occupation: document.getElementById('occupation').value.trim(),
          address: document.getElementById('address').value.trim(),
          contactNo: document.getElementById('contactNo').value.trim(),
          nomineeNameAndAddress: document.getElementById('nomineeDetails').value.trim() || "",
          totalAmount: parseFloat(document.getElementById('totalAmount').value),
          validTill: new Date().toISOString(),
          place: place,
          certificateURL: "certificate",
          verified: false,
        };
    
        if (!validateForm(formData)) {
          return;
        }
    
        try {
          const response = await fetch('https://mumbailocal.org:8084/api/v1/submit/details', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData),
          });
  
          if (!response.ok) {
            throw new Error('Failed to submit form');
          }
  
          const data = await response.json();
    
          if (data.status === 200) {
            alert('Form submitted successfully! Your record will be reviewed by the admin. Once confirmed, a certificate will be sent to you.');
            window.location.href = 'index.html';
          } else {
            alert('Failed to submit form. Please try again.');
          }
        } catch (error) {
          console.error('Error submitting form:', error);
          alert('Error submitting form. Please try again.');
        }
      }
  
      // Initialize page
      document.addEventListener('DOMContentLoaded', () => {
          checkAuth();
      });
    </script>
     <script>
      // Check for sessionStorage values
      document.addEventListener('DOMContentLoaded', function() {
          const token = sessionStorage.getItem("token");
          const message = sessionStorage.getItem("message");
          const status = sessionStorage.getItem("status");
  
          // Target the navbar
          const navbar = document.querySelector(".navbar-nav");
  
          // Logout Button
          const logoutItem = `
            <li class="nav-item">
                  <a class="nav-link text-white active" href="./userlist.html">USERLIST</a>
                
                </li>
              <li class="nav-item">
                  <a class="nav-link text-white" href="#" id="logoutBtn">LOGOUT</a>
              </li>
          `;
  
          // Login Button
          const loginItem = `
              <li class="nav-item">
                  <a class="nav-link text-white" href="./login.html">LOGIN</a>
              </li>
          `;
  
          if (token && message && status) {
              // If token, message, and status exist, show logout button
              navbar.innerHTML += logoutItem;
  
              // Add event listener for logout
              document.getElementById("logoutBtn").addEventListener("click", function() {
                  // Clear sessionStorage and redirect
                  sessionStorage.clear();
                  alert("You have successfully logged out.");
                  window.location.href = 'index.html';
              });
          } else {
              // If not logged in, ensure login button is visible
              navbar.innerHTML += loginItem;
          }
      });
  </script>
</body>

</html>